<body>
<style>
body {
  background-image: url('bg_jungle.png');
  background-size: 100% 100%;
}
.center {
  padding: 100px 0;
  text-align: center;
}
.center img:hover {
  filter: hue-rotate(90deg);
  filter: saturate(8);
}
</style>

<div id="container" class="center"></div>
</body>

<script>
/*
instruments = {
    'snare': {
        'audio': [AUDIO_ELEMENT_1, AUDIO_ELEMENT_2, ...],
        'index': CURRENT_AUDIO_ELEMENT_INDEX
    }
}
*/

var INSTRUMENT_IDS = [
  'snare',
  'bass',
  'cymbal',
  'bongo',
  'banana',
  'pow',
  'donut',
  'tongue']
const AUDIO_BUFFER = 10;

var instruments = new Object();


function initAudio(instrument_id) {
  let audio = [];
  for (let i = 0; i < AUDIO_BUFFER; i++) {
    var el = document.createElement('audio');
    el.id = 'audio_' + instrument_id + '_' + i;
    el.src = 'snd_' + instrument_id + '.mp3';
    audio[i] = el;
  }
  instruments[instrument_id] = {'audio': audio, 'index': 0};
}

function initImage(instrument_id) {
  let el = document.createElement("img");
  el.id = 'image_' + instrument_id;
  el.src = 'img_' + instrument_id + '.png';
  el.addEventListener("touchstart", handleTouchstart);
  el.addEventListener("mousedown", handleMousedown);
  document.getElementById("container").appendChild(el);
}

function initInstrument(instrument_id) {
  initAudio(instrument_id);
  initImage(instrument_id);
}

function init() {
  for (let i = 0; i < INSTRUMENT_IDS.length; i++) {
    initInstrument(INSTRUMENT_IDS[i]);
  }
}

init();


function play(instrument_id) {
  let instrument = instruments[instrument_id];
  try {
    instrument['audio'][instrument['index']].stop();
  } catch (e) {}
  if (instrument['index'] < AUDIO_BUFFER - 1) {
    instrument['index'] += 1;
  } else {
    instrument['index'] = 0;
  }
  instrument['audio'][instrument['index']].play();
}

function handleTouchstart(e) {
  let instrument_id = e.srcElement.id.split('_')[1];
  play(instrument_id);
  e.preventDefault();
}

function handleMousedown(e) {
  let instrument_id = e.srcElement.id.split('_')[1];
  play(instrument_id);
  e.preventDefault();

}
</script>   